---

- name: 1.1.1 Ensure that the API server pod specification file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/manifests/kube-apiserver.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.1","task_description":"Ensure that the API server pod specification file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.1","task_description":"Ensure that the API server pod specification file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
###
- name: 1.1.2 Ensure that the API server pod specification file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/manifests/kube-apiserver.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.2","task_description":"Ensure that the API server pod specification file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.2","task_description":"Ensure that the API server pod specification file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.3 Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/manifests/kube-controller-manager.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.3","task_description":"Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.3","task_description":"Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
############################################################################
- name: 1.1.4 Ensure that the controller manager pod specification file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/manifests/kube-controller-manager.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.4","task_description":"Ensure that the controller manager pod specification file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.4","task_description":"Ensure that the controller manager pod specification file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.5 Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/manifests/kube-scheduler.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.5","task_description":"Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.5","task_description":"Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
############################################################################
- name: 1.1.6 Ensure that the scheduler pod specification file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/manifests/kube-scheduler.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.6","task_description":"Ensure that the scheduler pod specification file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.6","task_description":"Ensure that the scheduler pod specification file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.7 Ensure that the etcd pod specification file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/manifests/etcd.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.7","task_description":"Ensure that the etcd pod specification file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.7","task_description":"Ensure that the etcd pod specification file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
############################################################################
- name: 1.1.8 Ensure that the etcd pod specification file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/manifests/etcd.yaml
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.8","task_description":"Ensure that the etcd pod specification file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.8","task_description":"Ensure that the etcd pod specification file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.9 Ensure that the Container Network Interface file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/cni/net.d/* | grep -v "600" || exit 0
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.9","task_description":"Ensure that the Container Network Interface file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":"600","script":"" }] }}'
      when: filestat.stdout == ''
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.9","task_description":"Ensure that the Container Network Interface file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != ''
############################################################################
- name: 1.1.10 Ensure that the Container Network Interface file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/cni/net.d/* | grep -v "root:root" || exit 0
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.10","task_description":"Ensure that the Container Network Interface file ownership is set to root:root","task_status":"PASSED","configuration":"root:root","script":"" }] }}'
      when: filestat.stdout == ''
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.10","task_description":"Ensure that the Container Network Interface file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != ''
############################################################################
- name: 1.1.11 Ensure that the etcd data directory permissions are set to 700 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /var/lib/minikube/etcd
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.11","task_description":"Ensure that the etcd data directory permissions are set to 700 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '700'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.11","task_description":"Ensure that the etcd data directory permissions are set to 700 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '700'
############################################################################
- name: 1.1.12 Ensure that the etcd data directory ownership is set to etcd:etcd
  block:
    - ansible.builtin.shell: stat -c %U:%G /var/lib/minikube/etcd
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.12","task_description":"Ensure that the etcd data directory ownership is set to etcd:etcd","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'etcd:etcd'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.12","task_description":"Ensure that the etcd data directory ownership is set to etcd:etcd","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'etcd:etcd'
############################################################################
- name: 1.1.13 Ensure that the admin.conf file permissions are set to 600
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/admin.conf
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.13","task_description":"Ensure that the admin.conf file permissions are set to 600","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.13","task_description":"Ensure that the admin.conf file permissions are set to 600","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
############################################################################
- name: 1.1.14 Ensure that the admin.conf file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/admin.conf
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.14","task_description":"Ensure that the admin.conf file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.14","task_description":"Ensure that the admin.conf file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.15 Ensure that the scheduler.conf file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/scheduler.conf
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.15","task_description":"Ensure that the scheduler.conf file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.15","task_description":"Ensure that the scheduler.conf file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
############################################################################
- name: 1.1.16 Ensure that the scheduler.conf file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/scheduler.conf
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.16","task_description":"Ensure that the scheduler.conf file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.16","task_description":"Ensure that the scheduler.conf file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.17 Ensure that the controller-manager.conf file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /etc/kubernetes/controller-manager.conf
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.17","task_description":"Ensure that the controller-manager.conf file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '600'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.17","task_description":"Ensure that the controller-manager.conf file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != '600'
############################################################################
- name: 1.1.18 Ensure that the controller-manager.conf file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /etc/kubernetes/controller-manager.conf
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.18","task_description":"Ensure that the controller-manager.conf file ownership is set to root:root","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'root:root'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.18","task_description":"Ensure that the controller-manager.conf file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'root:root'
############################################################################
- name: 1.1.19 Ensure that the Kubernetes PKI directory and file ownership is set to root:root
  block:
    - ansible.builtin.shell: stat -c %U:%G /var/lib/minikube/certs/ | grep -v "root:root" || exit 0
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.19","task_description":"Ensure that the Kubernetes PKI directory and file ownership is set to root:root","task_status":"PASSED","configuration":"root:root","script":"" }] }}'
      when: filestat.stdout == ''
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.19","task_description":"Ensure that the Kubernetes PKI directory and file ownership is set to root:root","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != ''
############################################################################
- name: 1.1.20 Ensure that the Container Network Interface file permissions are set to 600 or more restrictive
  block:
    - ansible.builtin.shell: stat -c %a /var/lib/minikube/certs/*.crt | grep -v "600" || exit 0
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.20","task_description":"Ensure that the Container Network Interface file permissions are set to 600 or more restrictive","task_status":"PASSED","configuration":"600","script":"" }] }}'
      when: filestat.stdout == ''
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.20","task_description":"Ensure that the Container Network Interface file permissions are set to 600 or more restrictive","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != ''
############################################################################
- name: 1.1.21 Ensure that the Kubernetes PKI key file permissions are set to 600
  block:
    - ansible.builtin.shell: stat -c %a /var/lib/minikube/certs/*.key | grep -v "600" || exit 0
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.21","task_description":"Ensure that the Kubernetes PKI key file permissions are set to 600","task_status":"PASSED","configuration":"600","script":"" }] }}'
      when: filestat.stdout == ''
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.1.21","task_description":"Ensure that the Kubernetes PKI key file permissions are set to 600","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != ''
############################################################################
- name: 1.2.2 Ensure that the --token-auth-file parameter is not set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-token\-auth\-file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.2","task_description":"Ensure that the --token-auth-file parameter is not set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.2","task_description":"Ensure that the --token-auth-file parameter is not set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'Argument is not set'
############################################################################
- name: 1.2.3 Ensure that the --DenyServiceExternalIPs is not set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep "\-\-DenyServiceExternalIPs" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.3","task_description":"Ensure that the --DenyServiceExternalIPs is not set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.3","task_description":"Ensure that the --DenyServiceExternalIPs is not set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout != 'Argument is not set'
############################################################################
- name: 1.2.4 Ensure that the --kubelet-client-certificate and --kubeletclient-key arguments are set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-kubelet\-client\-(key|certificate)=[^ ]+"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.4","task_description":"Ensure that the --kubelet-client-certificate and --kubeletclient-key arguments are set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout_lines|length == 2
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.4","task_description":"Ensure that the --kubelet-client-certificate and --kubeletclient-key arguments are set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout_lines|length < 2
############################################################################
- name: 1.2.5 Ensure that the --kubelet-certificate-authority argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-kubelet\-certificate\-authority=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.5","task_description":"Ensure that the --kubelet-certificate-authority argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.5","task_description":"Ensure that the --kubelet-certificate-authority argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.6 Ensure that the --authorization-mode argument is not set to AlwaysAllow
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-authorization\-mode=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.6","task_description":"Ensure that the --authorization-mode argument is not set to AlwaysAllow","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'AlwaysAllow' not in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.6","task_description":"Ensure that the --authorization-mode argument is not set to AlwaysAllow","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'AlwaysAllow' in filestat.stdout"
############################################################################
- name: 1.2.7 Ensure that the --authorization-mode argument includes Node
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-authorization\-mode=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.7","task_description":"Ensure that the --authorization-mode argument includes Node","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'Node' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.7","task_description":"Ensure that the --authorization-mode argument includes Node","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'Node' not in filestat.stdout"
############################################################################
- name: 1.2.8 Ensure that the --authorization-mode argument includes RBAC
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-authorization\-mode=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.8","task_description":"Ensure that the --authorization-mode argument includes RBAC","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'RBAC' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.8","task_description":"Ensure that the --authorization-mode argument includes RBAC","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'RBAC' not in filestat.stdout"
############################################################################
- name: 1.2.9 Ensure that the admission control plugin EventRateLimit is set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-enable\-admission\-plugins=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.9","task_description":"Ensure that the admission control plugin EventRateLimit is set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'EventRateLimit' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.9","task_description":"Ensure that the admission control plugin EventRateLimit is set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'EventRateLimit' not in filestat.stdout"
############################################################################
- name: 1.2.10 Ensure that the admission control plugin AlwaysAdmit is not set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-enable\-admission\-plugins=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.10","task_description":"Ensure that the admission control plugin AlwaysAdmit is not set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'AlwaysAdmit' not in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.10","task_description":"Ensure that the admission control plugin AlwaysAdmit is not set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'AlwaysAdmit' in filestat.stdout"
############################################################################
- name: 1.2.11 Ensure that the admission control plugin AlwaysPullImages is set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-enable\-admission\-plugins=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.11","task_description":"Ensure that the admission control plugin AlwaysPullImages","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'AlwaysPullImages' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.11","task_description":"Ensure that the admission control plugin AlwaysPullImages","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'AlwaysPullImages' not in filestat.stdout"
############################################################################
- name: 1.2.12 Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-enable\-admission\-plugins=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.12","task_description":"Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'SecurityContextDeny' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.12","task_description":"Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'SecurityContextDeny' not in filestat.stdout"
############################################################################
- name: 1.2.13 Ensure that the admission control plugin ServiceAccount is set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-disable\-admission\-plugins=[^ ]+" || echo "Argument is set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.13","task_description":"Ensure that the admission control plugin ServiceAccount is set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'ServiceAccount' not in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.13","task_description":"Ensure that the admission control plugin ServiceAccount is set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'ServiceAccount' in filestat.stdout"
############################################################################
- name: 1.2.14 Ensure that the admission control plugin NamespaceLifecycle is set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-disable\-admission\-plugins=[^ ]+" || echo "Argument is set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.14","task_description":"Ensure that the admission control plugin NamespaceLifecycle is set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'NamespaceLifecycle' not in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.14","task_description":"Ensure that the admission control plugin NamespaceLifecycle is set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'NamespaceLifecycle' in filestat.stdout"
############################################################################
- name: 1.2.15 Ensure that the admission control plugin NodeRestriction is set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-enable\-admission\-plugins=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.15","task_description":"Ensure that the admission control plugin NodeRestriction is set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'NodeRestriction' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.15","task_description":"Ensure that the admission control plugin NodeRestriction is set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'NodeRestriction' not in filestat.stdout"
############################################################################
- name: 1.2.16 Ensure that the --secure-port argument is not set to 0
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-secure\-port=[^ ]+"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.16","task_description":"Ensure that the --secure-port argument is not set to 0","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout == '' or filestat.stdout != '--secure-port=0'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.16","task_description":"Ensure that the --secure-port argument is not set to 0","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == '--secure-port=0'
############################################################################
- name: 1.2.17 Ensure that the --profiling argument is set to false
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-profiling=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.17","task_description":"Ensure that the --profiling argument is set to false","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'false' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.17","task_description":"Ensure that the --profiling argument is set to false","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'false' not in filestat.stdout"
############################################################################
- name: 1.2.18 Ensure that the --audit-log-path argument is set
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-audit\-log\-path=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.18","task_description":"Ensure that the --audit-log-path argument is set","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.18","task_description":"Ensure that the --audit-log-path argument is set","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.19 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-audit\-log\-maxage=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.19","task_description":"Ensure that the --audit-log-maxage argument is set to 30 or as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.19","task_description":"Ensure that the --audit-log-maxage argument is set to 30 or as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.20 Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-audit\-log\-maxbackup=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.20","task_description":"Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.20","task_description":"Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.21 Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-audit\-log-maxsize=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.21","task_description":"Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.21","task_description":"Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.22 Ensure that the --request-timeout argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-request\-timeout=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.22","task_description":"Ensure that the --request-timeout argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.22","task_description":"Ensure that the --request-timeout argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.23 Ensure that the --service-account-lookup argument is set to true
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-service\-account\-lookup=[^ ]+" ||  echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.23","task_description":"Ensure that the --service-account-lookup argument is set to true","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'true' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.23","task_description":"Ensure that the --service-account-lookup argument is set to true","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'true' not in filestat.stdout"
############################################################################
- name: 1.2.24 Ensure that the --service-account-key-file argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-service\-account\-key\-file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.24","task_description":"Ensure that the --service-account-key-file argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.24","task_description":"Ensure that the --service-account-key-file argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.25 Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-etcd\-(cert|key)file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.25","task_description":"Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout_lines|length == 2
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.25","task_description":"Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout_lines|length < 2
############################################################################
- name: 1.2.26 Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE " \-\-tls\-(cert|private\-key)\-file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.26","task_description":"Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout_lines|length == 2
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.26","task_description":"Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout_lines|length < 2
############################################################################
- name: 1.2.27 Ensure that the --client-ca-file argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE " \-\-client\-ca\-file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.27","task_description":"Ensure that the --client-ca-file argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.27","task_description":"Ensure that the --client-ca-file argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.28 Ensure that the --etcd-cafile argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-etcd\-cafile=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.28","task_description":"Ensure that the --etcd-cafile argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.28","task_description":"Ensure that the --etcd-cafile argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.2.29 Ensure that the --encryption-provider-config argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-apiserver | grep -oE "\-\-encryption\-provider\-config=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.29","task_description":"Ensure that the --encryption-provider-config argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.2.29","task_description":"Ensure that the --encryption-provider-config argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.3.1 Ensure that the --terminated-pod-gc-threshold argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -oE "\-\-terminated\-pod\-gc\-threshold=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.1","task_description":"Ensure that the --terminated-pod-gc-threshold argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.1","task_description":"Ensure that the --terminated-pod-gc-threshold argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.3.2 Ensure that the --profiling argument is set to false
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -oE "\-\-profiling=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.2","task_description":"Ensure that the --profiling argument is set to false","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'false' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.2","task_description":"Ensure that the --profiling argument is set to false","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'false' not in filestat.stdout"
############################################################################
- name: 1.3.3 Ensure that the --use-service-account-credentials argument is set to true
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -oE "\-\-use-service\-account\-credentials=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.3","task_description":"Ensure that the --use-service-account-credentials argument is set to true","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'true' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.3","task_description":"Ensure that the --use-service-account-credentials argument is set to true","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'true' not in filestat.stdout"
############################################################################
- name: 1.3.4 Ensure that the --service-account-private-key-file argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -oE "\-\-service\-account\-private\-key\-file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.4","task_description":"Ensure that the --service-account-private-key-file argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.4","task_description":"Ensure that the --service-account-private-key-file argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.3.5 Ensure that the --root-ca-file argument is set as appropriate
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -oE "\-\-service\-account\-private\-key\-file=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.5","task_description":"Ensure that the --root-ca-file argument is set as appropriate","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.5","task_description":"Ensure that the --root-ca-file argument is set as appropriate","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.3.6 Ensure that the RotateKubeletServerCertificate argument is set to true
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -o "\-\-feature\-gates=RotateKubeletServerCertificate=true" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.6","task_description":"Ensure that the RotateKubeletServerCertificate argument is set to true","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: filestat.stdout != 'Argument is not set'
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.6","task_description":"Ensure that the RotateKubeletServerCertificate argument is set to true","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: filestat.stdout == 'Argument is not set'
############################################################################
- name: 1.3.7 Ensure that the --bind-address argument is set to 127.0.0.1
  block:
    - ansible.builtin.shell: ps -ef | grep kube-controller-manager | grep -oE "\-\-bind\-address=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.7","task_description":"Ensure that the --bind-address argument is set to 127.0.0.1","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'127.0.0.1' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.3.7","task_description":"Ensure that the --bind-address argument is set to 127.0.0.1","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'127.0.0.1' not in filestat.stdout"
############################################################################
- name: 1.4.1 Ensure that the --profiling argument is set to false
  block:
    - ansible.builtin.shell: ps -ef | grep kube-scheduler | grep -oE "\-\-profiling=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.4.1","task_description":"Ensure that the --profiling argument is set to false","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'false' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.4.1","task_description":"Ensure that the --profiling argument is set to false","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'false' not in filestat.stdout"
############################################################################
- name: 1.4.2 Ensure that the --bind-address argument is set to 127.0.0.1
  block:
    - ansible.builtin.shell: ps -ef | grep kube-scheduler | grep -oE "\-\-bind\-address=[^ ]+" || echo "Argument is not set"
      register: filestat
      ignore_errors: yes
      changed_when: false
    - name: Add passed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.4.2","task_description":"Ensure that the --bind-address argument is set to 127.0.0.1","task_status":"PASSED","configuration":filestat.stdout,"script":"" }] }}'
      when: "'127.0.0.1' in filestat.stdout"
    - name: Add failed task to list 
      set_fact:
        section1_tasks: '{{ section1_tasks + [{ "task_number":"1.4.2","task_description":"Ensure that the --bind-address argument is set to 127.0.0.1","task_status":"FAILED","configuration":filestat.stdout,"script":"Script here" }] }}'
      when: "'127.0.0.1' not in filestat.stdout"